"use strict";(self.webpackChunknode_cli_docs=self.webpackChunknode_cli_docs||[]).push([[403],{5565:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>l});var o=i(4848),d=i(8453);const t={title:"Build with nix",id:"build-with-nix",sidebar_position:2,keywords:["Get-started","build with nix","installation","cardano-node"]},r="Building Cardano Node with nix",a={id:"cardano-node/build-with-nix",title:"Build with nix",description:"The Nix Package Manager can be installed on most Linux distributions by downloading and",source:"@site/docs/cardano-node/nix.md",sourceDirName:"cardano-node",slug:"/cardano-node/build-with-nix",permalink:"/cardano-node/build-with-nix",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/cardano-node/nix.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Build with nix",id:"build-with-nix",sidebar_position:2,keywords:["Get-started","build with nix","installation","cardano-node"]},sidebar:"tutorialSidebar",previous:{title:"Build from source",permalink:"/cardano-node/build-from-source"},next:{title:"Pre-compiled binaries",permalink:"/cardano-node/precompiled-binaries"}},c={},l=[{value:"IOHK Binary Cache",id:"iohk-binary-cache",level:4},{value:"Building and running with nix",id:"building-and-running-with-nix",level:3},{value:"Development environments",id:"development-environments",level:3}];function s(n){const e={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,d.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"building-cardano-node-with-nix",children:"Building Cardano Node with nix"}),"\n",(0,o.jsxs)(e.p,{children:["The ",(0,o.jsx)(e.a,{href:"https://nixos.org/nix/",children:"Nix Package Manager"})," can be installed on most Linux distributions by downloading and\nrunning the installation script:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"curl -L https://nixos.org/nix/install > install-nix.sh\nchmod +x install-nix.sh\n./install-nix.sh\n"})}),"\n",(0,o.jsx)(e.p,{children:"and following the directions."}),"\n",(0,o.jsxs)(e.p,{children:["Then the ",(0,o.jsx)(e.a,{href:"https://nixos.wiki/wiki/Flakes",children:"Flake"})," feature of nix (and IFD support) should be enabled:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"sudo mkdir -p /etc/nix\ncat <<EOF | sudo tee /etc/nix/nix.conf\nexperimental-features = nix-command flakes\nallow-import-from-derivation = true\nEOF\n"})}),"\n",(0,o.jsx)(e.h4,{id:"iohk-binary-cache",children:"IOHK Binary Cache"}),"\n",(0,o.jsxs)(e.p,{children:["To improve build speed, it is possible to set up a binary cache maintained by IOHK (",(0,o.jsx)(e.strong,{children:"this is\noptional"}),"):"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"sudo mkdir -p /etc/nix\ncat <<EOF | sudo tee -a /etc/nix/nix.conf\nsubstituters = https://cache.nixos.org https://cache.iog.io\ntrusted-public-keys = hydra.iohk.io:f/Ea+s+dFdN+3Y/G+FDgSq+a5NEWhJGzdjvKNGv0/EQ= cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY=\nEOF\n"})}),"\n",(0,o.jsx)(e.h3,{id:"building-and-running-with-nix",children:"Building and running with nix"}),"\n",(0,o.jsx)(e.p,{children:"Once Nix is installed, log out and then log back in.\nAfter that you can build the full node package with Mainnet configuration as follows:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"git clone https://github.com/intersectmbo/cardano-node\ncd cardano-node\nnix build .#mainnet/node -o mainnet-node-local\n./mainnet-node-local/bin/cardano-node-mainnet\n"})}),"\n",(0,o.jsx)(e.p,{children:"or run in in one go:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"nix run github:intersectmbo/cardano-node#mainnet/node\n"})}),"\n",(0,o.jsx)(e.p,{children:"If you only want to build just the cardano-node executable, without the configuration bundle:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"nix build .#cardano-node -o cardano-node-build\n"})}),"\n",(0,o.jsx)(e.p,{children:"To build the cardano-cli executable, follow the steps below:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"nix build .#cardano-cli -o cardano-cli-build\n./cardano-cli-build/bin/cardano-cli\n"})}),"\n",(0,o.jsx)(e.p,{children:"Or run directly, eg.:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"nix run .#cardano-cli -- version\n"})}),"\n",(0,o.jsx)(e.h3,{id:"development-environments",children:"Development environments"}),"\n",(0,o.jsx)(e.p,{children:"A shell environment with pre-compiled, cached, cabal dependencies is available with:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"nix develop\n"})}),"\n",(0,o.jsx)(e.p,{children:"An environment with dependencies compiled with profiling enabled is available with:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"nix develop .#profiled\n"})})]})}function h(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(s,{...n})}):s(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>a});var o=i(6540);const d={},t=o.createContext(d);function r(n){const e=o.useContext(t);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:r(n.components),o.createElement(t.Provider,{value:e},n.children)}}}]);